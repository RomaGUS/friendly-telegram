<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta http-equiv="X-UA-Compatible" content="ie=edge" />

		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.6.5/alt/video-js-cdn.min.css">
		<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css">

		<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/video.js/7.6.5/video.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-hls/5.15.0/videojs-contrib-hls.min.js"></script>

		<style>
			body {
				padding: 20px;
			}
		</style>
		
		<title>Document</title>
	</head>
	<body>
		<div class="input-group-append">
			<button type="submit" id="btnSubmit" class="btn btn-primary">Upload</button>
		</div>

		<form method="post" enctype="multipart/form-data" id="fileUploadForm">
			<input name="video" type="file">
		</form>

		<img id="upload-preview" src="" alt="">

		<!-- <img src="https://cdn.hikka.io/volbil/hikka_da92080672e8a49917e3aa0bb237ead8.jpg" alt=""> -->

		<hr>

		<video id=example-video width=960 height=540 class="video-js vjs-default-skin" controls>
			<source src="https://cdn.hikka.io/video/54ea7ceddf3ee8a574a5d1f721da7ced/bfc40344235372b8964a66f6a93d34e5.mp4" type="video/mp4">
		</video>

		<script>
			function progress(e) {
				if(e.lengthComputable){
					var max = e.total
					var current = e.loaded
					var percentage = (current * 100) / max
					console.log(percentage)
				}  
			}

			$(document).ready(function() {
				$("#btnSubmit").click(function(e) {
					e.preventDefault();
					var form = $('#fileUploadForm')[0];
					var data = new FormData(form)

					data.append("position", 0)
					data.append("team", "fanvox")
					data.append("slug", "kaguya-sama")

					$.ajax({
						type: "POST",
						enctype: "multipart/form-data",
						url: "/episodes/update",
						data: data,
						processData: false,
						contentType: false,
						cache: false,
						timeout: 600000,
						beforeSend: function(request) {
							request.setRequestHeader("Authentication", "3nT8FnbSgJ2jyd4n97uiAp8J4m5o6GHuYpbsSVbHxJnUepd.ZMKC1hNPqdfkmnGBbzBZRyFxaagjRewcWqBUd2dc72GrWwkGDtq5LS4dnnL5n8BWk79o7e4xHHfdXZKZaPJsxu.Ns4b38iy3JN2P5aPi6FJ7RkayTjMkE7CfsxHnnEb5Sows8ejiFks59EcgTBYPbGvR7em3iaagQTq7NY6oDBmGaH2rLKhf");
						},
						xhr: function() {
								var myXhr = $.ajaxSettings.xhr();
								if(myXhr.upload){
									myXhr.upload.addEventListener("progress", progress, false);
								}
								return myXhr;
						},
						success: function (data) {
							console.log("SUCCESS : ", data);
						},
						error: function (e) {
							console.log("ERROR : ", e.responseJSON);
						}
					});
				});

				var player = videojs('example-video');
				player.play();

			});

		</script>
	</body>
</html>